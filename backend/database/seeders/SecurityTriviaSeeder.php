<?php

namespace Database\Seeders;

use App\Models\SecurityTrivia;
use Illuminate\Database\Seeder;

class SecurityTriviaSeeder extends Seeder
{
    public function run(): void
    {
        $mgt = [
            ['category' => 'MGT', 'content' => '物理的セキュリティ対策として、鍵付きキャビネットやICカードによる入退室管理、監視カメラの設置などが挙げられます。デジタル対策が万全でも、サーバ室に誰でも入れる状態では機密性を維持することは困難です。'],
            ['category' => 'MGT', 'content' => 'テレワーク実施時は、VPNによる通信の暗号化や多要素認証の導入、さらに「端末へのデータ保存禁止」といった運用ルールが不可欠です。物理的な管理が届かない環境でのリスクを、技術とルールの両面で補完します。'],
            ['category' => 'MGT', 'content' => 'モバイルデバイス管理 (MDM) は、会社支給のスマホやタブレットを一元管理するツールです。紛失時のリモートワイプ（データ消去）や、指定した安全なアプリ以外のインストール禁止などの制御を効率的に行えます。'],
            ['category' => 'MGT', 'content' => 'セキュリティパッチの適用ルールは、緊急度に応じた適用期限を定めることが重要です。すべてのパッチを即座に当てるのが理想ですが、業務影響を考慮しつつ、深刻な脆弱性をいかに迅速に塞ぐかという運用のバランスが問われます。'],
            ['category' => 'MGT', 'content' => '個人情報保護法や経済安保推進法などの法規制対応も、ISMSの「遵守」の範囲に含まれます。法改正の動向をタイムリーに把握し、組織のルールやシステムに反映させる法務的センスも、セキュリティ担当者には求められます。'],
            ['category' => 'MGT', 'content' => 'バックアップデータの保存期間は、ビジネスの継続性だけでなく法的要件も考慮して決定します。例えば会計監査のためのデータであれば数年間の保存が義務付けられており、必要な時に正しくリストアできることを定期的に検証すべきです。'],
            ['category' => 'MGT', 'content' => 'ログの保存期間は、事故発生後のフォレンジック調査に必要となる期間を考慮して設定します。高度な攻撃は年単位で潜伏することもあるため、ストレージコストを考慮しつつ、ある程度の長期保管が推奨される場合もあります。'],
            ['category' => 'MGT', 'content' => '標的型メール訓練は、巧妙化する攻撃メールに従業員がどう反応するかを擬似的にテストする手法です。単に「引っかかった人を責める」のではなく、不審なメールに気づき、迅速に報告する体制を定着させることを目的とします。'],
            ['category' => 'MGT', 'content' => 'クラウドサービスの利用にあたっては、責任分界点 (Shared Responsibility Model) を明確に理解する必要があります。インフラは事業者が守る一方、データ自体やアクセス設定は利用者が責任を持つという切り分けを意識しましょう。'],
            ['category' => 'MGT', 'content' => '特権ID（Adminやroot）の利用制限はセキュリティの要です。共有アカウントでのログインを禁止し、個人を特定できるIDから一時的に権限を昇格させる運用と、その利用ログの第三者チェックを組み合わせるのが理想的です。'],
            ['category' => 'MGT', 'content' => '外部記憶媒体（USBメモリ等）の利用禁止は、マルウェアの感染経路遮断と情報持ち出し防止に極めて有効です。どうしても必要な場合は、暗号化機能付きの専用媒体のみを許可し、貸出ログを徹底して管理するべきです。'],
            ['category' => 'MGT', 'content' => 'シャドーIT（未承認のSaaS利用等）は、組織の管理が及ばない場所にデータが置かれるリスクを生みます。厳しく禁止するだけでなく、利便性の高い正規ツールを提供し、安全に業務を行える環境を整える「攻めの管理」が有効です。'],
            ['category' => 'MGT', 'content' => 'セキュリティ監査には、組織内部で実施する「内部監査」と、外部の専門機関による「外部監査」があります。第三者の客観的な視点を入れることで、自分たちでは気づかなかった「慣れ」による不備を見つけやすくなります。'],
            ['category' => 'MGT', 'content' => '是非処置は、発生した不適合の原因を突き止め、再発を防止するための活動です。一方「修正」は目の前の問題を直すことであり、ISMSでは根本原因を断ち切る「是正処置」のプロセスを回すことが真の改善に繋がります。'],
            ['category' => 'MGT', 'content' => '予防処置は、まだ問題が発生していない段階でリスクの芽を摘み取る活動です。ヒヤリハット事例の収集や脆弱性情報の監視を通じ、事故が起きる前にプロセスを改善する、プロアクティブな姿勢がISMSには求められます。'],
            ['category' => 'MGT', 'content' => 'リスクアセスメントの3要素は「資産、脅威、脆弱性」です。守るべきものは何か、どのような危険があるか、どこに隙があるかを分析し、リスクの大きさを数値化することで、対策の優先順位を明確にします。'],
            ['category' => 'MGT', 'content' => 'リスク対応には「低減、移転、回避、保有」の4つの選択肢があります。すべてをゼロにするのは不可能。コストと効果を考慮し、重要度の低いリスクはあえて受け入れる「保有」も経営上重要な判断となります。'],
            ['category' => 'MGT', 'content' => '情報セキュリティ方針（基本方針）は、経営トップが組織全体の姿勢を宣言する文書です。全従業員に周知し、社会的な信頼を維持するための確固たる意志を示すことで、組織文化の土台を築きます。'],
            ['category' => 'MGT', 'content' => '機密性 (Confidentiality) は、許可された人だけが情報にアクセスできることを保証します。情報の漏えいを防ぐための暗号化やアクセス制御が、この側面を守るための主要な技術対策となります。'],
            ['category' => 'MGT', 'content' => '完全性 (Integrity) は、情報が改ざんされず、正確で最新の状態であることを保証します。ハッシュ値による改ざん検知や、承認プロセスの徹底により、データの信頼性を維持します。'],
            ['category' => 'MGT', 'content' => '可用性 (Availability) は、必要な時にいつでも情報やシステムが利用できることを保証します。バックアップ、冗長化、DoS攻撃対策などが、ビジネスを止めないための可用性確保に直結します。'],
            ['category' => 'MGT', 'content' => 'ISMSのPDCAサイクルにおいて、D (Do) は計画した対策の導入・運用を指します。マニュアルを作るだけでなく、実際に運用し、その記録（エビデンス）を残すことが、後の監査や改善において不可欠な要素となります。'],
            ['category' => 'MGT', 'content' => '事業継続計画 (BCP) は、災害や事故でシステムが停止した際の復旧手順と優先順位を定めます。単なるITの復旧だけでなく、代替手段の確保や対外公表など、事業を維持するための経営レベルの戦略です。'],
            ['category' => 'MGT', 'content' => 'RTO (目標復旧時間) は、事故発生からシステムを復旧させるまでの目標時間です。また、RPO (目標復旧時点) は、どの時点のデータまで戻すかの目標を指し、これらによって必要なバックアップの方式が決まります。'],
            ['category' => 'MGT', 'content' => '情報資産台帳は、組織が持つデータを洗い出し、その重要度（機密性・完全性・可用性）を格付けしたリストです。何を守るべきかが明確にならなければ、適切な投資判断を下すことはできません。'],
            ['category' => 'MGT', 'content' => '職務分掌 (職務の分離) は、一人の人間が重要な承認ステップをすべて完結できないようにする仕組みです。例えば、開発担当と本番反映承認者を分けることで、不正や誤操作による事故のリスクを分散します。'],
            ['category' => 'MGT', 'content' => '供給者関係のセキュリティでは、委託先の選定基準や定期的な監査（報告書の提出等）を契約に盛り込みます。自社のセキュリティレベルが高くても、委託先の不備から情報が漏えいする「サプライチェーンリスク」への備えです。'],
            ['category' => 'MGT', 'content' => 'クリアデスク・クリアスクリーンは、離席時に重要書類を放置せず、画面をロックする運用ルールです。不特定多数が出入りする環境では、物理的な情報の盗み見が最も単純かつ強力な脅威となるため、徹底が必要です。'],
            ['category' => 'MGT', 'content' => '人的資源のセキュリティは、雇用前・雇用中・退職時の各フェーズでの対策を指します。機密保持契約 (NDA) の締結や、退職者アカウントの即時削除など、内部不正や情報の持ち出しを防ぐための体系的な管理です。'],
            ['category' => 'MGT', 'content' => 'インシデント管理の目的は、事故によるビジネスへの影響を最小限に抑え、通常の運用状態に最短で戻すことです。原因究明も大切ですが、まずは「復旧」を最優先に動くことが、運用管理の鉄則です。'],
            ['category' => 'MGT', 'content' => 'アセットの廃棄時には、データの完全消去を物理的またはソフト的に行い、廃棄業者から「消去完了証明書」を受け取ります。シリアル番号ベースで管理することで、物理的な漏えいルートを完全に遮断します。'],
            ['category' => 'MGT', 'content' => 'マネジメントレビューは、経営層がISMSの運用状況を評価し、方針の変更やリソースの追加投入を指示する場です。トップの関与なくして、組織全体のセキュリティレベルを継続的に高めることは困難です。'],
            ['category' => 'MGT', 'content' => '例外管理プロセスは、業務上の理由で標準ルールを守れない場合の承認手順です。一律の禁止ではなく、リスクを認めた上で代替策（監視の強化等）を講じ、期間限定で許可するなどの柔軟性と統制の両立を図ります。'],
            ['category' => 'MGT', 'content' => '内部通報制度の整備は、組織内の不正を早期に発見するための自浄作用として機能します。通報者の不利益にならない保護規定を設け、経営陣が真摯に耳を傾ける姿勢を示すことで、内部不正の強力な抑止力となります。'],
            ['category' => 'MGT', 'content' => 'サプライチェーンの透明性確保のため、ソフトウェア部品表 (SBOM) の活用が広がっています。製品にどのようなライブラリが含まれているかを可視化することで、新たな脆弱性が見つかった際の影響範囲特定を迅速に行えます。'],
            ['category' => 'MGT', 'content' => 'BYOD (私物端末の業務利用) においては、業務データの隔離 (コンテナ化) やMDM導入を条件にします。個人のプライバシーと業務の機密性をいかに技術的に切り分けるかが、MGTフェーズの腕の見せ所です。'],
            ['category' => 'MGT', 'content' => 'サードパーティリスク管理 (TPRM) では、委託先だけでなく、その先の再委託先のリスクも考慮します。連鎖する委託関係の中で、自組織のデータがどのように扱われているかを把握し、契約と監査で統制します。'],
            ['category' => 'MGT', 'content' => 'コンプライアンス管理において、国内外の法規制 (GDPR等) への準拠を確認します。単なる技術的防御だけでなく、違反による巨額の制裁金や社会的信用の失墜を回避するための経営リスク管理です。'],
            ['category' => 'MGT', 'content' => 'セキュリティ意識向上プログラムは、一度きりの研修ではなく、継続的なコミュニケーションが大切です。最新 service の攻撃事例や社内ルールの意図を平易な言葉で伝え続けることで、従業員一人ひとりを「センサー」に変えていきます。'],
            ['category' => 'MGT', 'content' => '物理的セキュリティ境界は、フェンス、壁、カードリーダーなどで定義されます。重要エリアへ近づくにつれて認証ステップを厳しくする「多層防御」の考え方を物理空間にも適用し、内部者による不正も未然に防ぎます。'],
            ['category' => 'MGT', 'content' => '特権アクセスの二名立ち会いは、一人による独断での不正実行を物理的・心理的に阻止します。特に本番データの一括消去や全システム停止といった取り返しのつかない操作には、相互監視の体制が不可欠です。'],
            ['category' => 'MGT', 'content' => '資産の所有者 (Asset Owner) は、その資産の機密区分を決定し、誰にアクセス権を与えるべきかを最終的に判断する責任を負います。IT担当ではなく、業務を執行する部門の長が任命されるべきです。'],
            ['category' => 'MGT', 'content' => 'ISMSの適用範囲 (Scope) は、組織全体の場合もあれば、特定の部門やサービスのみに限定することもできます。ただし、重要なビジネスプロセスが範囲外にならないよう、リスクベースで適切に境界を設定します。'],
            ['category' => 'MGT', 'content' => 'ステークホルダーへの報告体制を整えることは、インシデント時のパニックを防ぎます。顧客、監督官庁、メディアに対して「いつ、何を、誰が発信するか」をあらかじめ定義し、情報の齟齬による二次被害を最小限に抑えます。'],
            ['category' => 'MGT', 'content' => 'セキュリティ投資の意思決定には、ROI (投資対効果) だけでなく、ALE (年間想定損害額) を用いた定量的な分析も役立ちます。リスクを放置した場合の損失コストと対策コストを比較し、最適な資源配分を行います。'],
            ['category' => 'MGT', 'content' => '管理策の有効性測定は、導入した対策が本当に機能しているかを数値で示します。例えば「パッチ適用率」や「研修後のテスト正答率」などをKPIとし、形だけの管理にならないよう継続的にモニタリングします。'],
            ['category' => 'MGT', 'content' => '組織の変革に伴うリスク管理 (MOC) は、システム構成や組織構造の変更時に、新たな脆弱性が生まれないかを確認するプロセスです。スピードの速いDX環境において、ガバナンスを失わないための要となります。'],
            ['category' => 'MGT', 'content' => '機密情報の郵送・搬送プロセスの管理もMGTの範囲です。追跡可能な手段の利用、内容物の暗号化や鍵付きバックの使用など、デジタル世界から物理世界への境界をまたぐ際のバトンタッチを完璧に行います。'],
            ['category' => 'MGT', 'content' => 'クラウドガバナンスを効かせるため、組織横断のCCoE (Cloud Center of Excellence) を設立する例が増えています。各チームの独断でのクラウド利用を防ぎ、セキュリティ基準の統一化とベストプラクティスの共有を図ります。'],
            ['category' => 'MGT', 'content' => 'セキュリティホール情報の常時監視体制を構築しましょう。JVNなどの脆弱性ポータルや、利用製品のベンダーアラートを即座にISMSの運用フローに取り込み、後手に回らない機敏な対応を実現します。'],
        ];

        $sys = [
            ['category' => 'SYS', 'content' => 'セキュリティバイデザインとは、システムの企画・設計段階からセキュリティ対策を組み込む考え方です。リリース後に不備が見つかって修正するよりもコストを低く抑えられ、より堅牢なシステムを構築することが可能になります。'],
            ['category' => 'SYS', 'content' => 'WAF (Web Application Firewall) は、HTTP/HTTPS通信の内容を詳細に解析してSQLインジェクションやXSSなどの攻撃を遮断します。ネットワーク層のFWでは防げない、アプリケーション固有の脆弱性を狙った攻撃への対策として有効です。'],
            ['category' => 'SYS', 'content' => 'SQLインジェクションの根本的な対策は、プレースホルダ（プリペアドステートメント）を利用することです。ユーザーからの入力を「データ」として扱い、SQLの構文として解釈させないことで、データベースの不正操作を防止します。'],
            ['category' => 'SYS', 'content' => 'クロスサイトスクリプティング (XSS) 対策の基本は、HTML出力時に特別な意味を持つ文字（<, >, &, "等）をエスケープ処理することです。また、Content-Security-Policy (CSP) を設定し、許可したソース以外のスクリプト実行を制限するのも有効です。'],
            ['category' => 'SYS', 'content' => 'CSRF（クロスサイトリクエストフォージェリ）は、利用者が意図しないリクエストを送信させられる攻撃です。対策として、処理実行時に推測困難なワンタイムトークンを確認し、正規の画面遷移を経て送られたリクエストかを確認します。'],
            ['category' => 'SYS', 'content' => 'バッファオーバーフローは、プログラムが確保したメモリ領域を超えるデータを書き込むことで動作を不安定にしたり、悪意あるコードを実行させたりする攻撃です。C/C++などのメモリ管理を開発者が行う言語では特に注意が必要です。'],
            ['category' => 'SYS', 'content' => 'ファジング (Fuzzing) は、ソフトウェアに予測不可能な「不正なデータ」を大量に流し込み、クラッシュや例外の有無を確認するテスト手法です。未知の脆弱性（ゼロデイ脆弱性）を発見するための強力な手段として活用されています。'],
            ['category' => 'SYS', 'content' => 'DMZ（非武装地帯）には、Webサーバやメールサーバなどの外部公開用サーバを配置します。内部ネットワークのデータベースサーバ等とはセグメントを分離し、外部から内部への直接の通信を遮断することで、多層防御を実現します。'],
            ['category' => 'SYS', 'content' => 'ディレクトリトラバーサルは、相対パス指定（../など）を悪用して本来アクセスできないファイル（設定ファイル等）を閲覧する攻撃です。入力値をファイル名として許容する文字のみに限定し、パスの正規化を行ってチェックします。'],
            ['category' => 'SYS', 'content' => 'OSコマンドインジェクションは、外部からの入力をそのままOSのコマンドに渡す実装の隙を突いた攻撃です。サーバーを乗っ取られる恐れがあるため、可能な限りシステム関数やシェル経由のコマンド実行は避けるべきです。'],
            ['category' => 'SYS', 'content' => 'セッション管理において、セッションIDは推測困難なランダム値（エントロピーが高いもの）である必要があります。また、ログイン成功時にセッションIDを新しく振り直す「セッション固定攻撃」への対策も、システムの基本要件です。'],
            ['category' => 'SYS', 'content' => 'クッキーのHttpOnly属性を有効にすると、ブラウザ上のJavaScriptからそのクッキーにアクセスできなくなります。これにより、万が一XSSが成功した場合でも、攻撃者がセッションIDを盗み出すリスクを大幅に下げられます。'],
            ['category' => 'SYS', 'content' => 'クッキーのSecure属性は、HTTPS通信時のみクッキーを送信するようブラウザに指示します。これにより、平文のHTTP通信路を流れるパケットをキャプチャされても、セッションIDが漏えいするのを防ぐことができます。'],
            ['category' => 'SYS', 'content' => 'HSTS (HTTP Strict Transport Security) は、サイトへのアクセスを常にHTTPSで行うようブラウザに強制する機能です。初回アクセス時の平文通信を狙った攻撃や、SSL剥ぎ取り攻撃などへの有効な防御策となります。'],
            ['category' => 'SYS', 'content' => 'STRIDEは、脅威を「なりすまし、改ざん、否認、情報漏えい、サービス拒否、権限昇格」の6つに分類するフレームワークです。設計段階で脅威モデリングを行う際に、漏れなく攻撃パターンを検討するためのツールとして活用します。'],
            ['category' => 'SYS', 'content' => 'ペネトレーションテストは、専門家が攻撃者の視点で実際に侵入を試みるテストです。脆弱性診断が「穴探し」であるのに対し、ペネトレーションテストは「特定の目的（データの奪取等）を達成できるか」という実効性を確認します。'],
            ['category' => 'SYS', 'content' => 'サブリソース完全性 (SRI) は、CDN等から外部のJSファイルを読み込む際に「期待されるハッシュ値」を指定する仕組みです。万が一CDN側でコードが改ざんされても、ブラウザがハッシュの不一致を検知して実行を阻止します。'],
            ['category' => 'SYS', 'content' => 'パスワードのハッシュ化に「ソルト (Salt)」を加えると、同じパスワードでもユーザーごとにハッシュ値が異なります。これにより、大量のパスワードとハッシュの対応表を用いた「レインボーテーブル攻撃」を実質的に無効化できます。'],
            ['category' => 'SYS', 'content' => 'オープンリダイレクトは、URLパラメータで指定された任意のURLにリダイレクトしてしまう脆弱性です。正規ドメインから始まるURLで偽サイトに誘導されるため、フィッシング攻撃のリンクとして悪用されるリスクがあります。'],
            ['category' => 'SYS', 'content' => 'クリックジャッキングは、透明なiframeを用いて他のサイトのボタンを重層的に配置し、利用者に意図しないクリックをさせる攻撃です。X-Frame-Optionsヘッダ等で自サイトが他サイトに埋め込まれるのを防ぎます。'],
            ['category' => 'SYS', 'content' => 'デフォルトパスワードは攻撃者の格好の標的です。機器やシステムの初回セットアップ時に、複雑なパスワードへの強制変更を求める、あるいは初期設定ユーザーを無効化するプロセスを組み込むことがセキュリティの基本です。'],
            ['category' => 'SYS', 'content' => '最小権限の原則 (Least Privilege) は、アプリケーションの実行ユーザーにも適用しましょう。例えば、Webアプリケーションはroot権限ではなく、必要最低限のファイル読み書き権限のみを持つ専用のユーザーで動作させるべきです。'],
            ['category' => 'SYS', 'content' => 'Defense in Depth (多層防御) は、たとえ一箇所の保護が破られても、次の防衛線で食い止める考え方です。WAFでフィルタし、アプリ側でバリデーションを行い、DBを暗号化するという多段構造により、致命的な被害を防ぎます。'],
            ['category' => 'SYS', 'content' => 'ゼロ知識証明は、パスワードそのものを相手に伝えずに「自分はその情報を知っている」ことだけを証明する認証技術です。サーバ側にパスワード情報を持たせないことで、DBからの個人情報流出リスクを根本的に低減できます。'],
            ['category' => 'SYS', 'content' => 'OAuth 2.0 は、パスワードを渡すことなく、特定のアプリケーションに対して自身のアカウントの一部リソースへのアクセスを認可する仕組みです。アクセストークンの有効期限設定やスコープ制限を正しく行うことが安全運用の鍵です。'],
            ['category' => 'SYS', 'content' => 'OpenID Connect (OIDC) は、OAuth 2.0を拡張して、異なるサイト間で「ID（本人確認情報）」を安全に連携する認証プロトコルです。自前のID管理コストを下げつつ、適切な属性受け渡しと署名検証により信頼性を担保します。'],
            ['category' => 'SYS', 'content' => 'セキュリティバイデフォルトは、製品やサービスの初期設定をあらかじめ「最も安全な状態」にしておく考え方です。ユーザーが知識不足で設定を怠っても、デフォルトで通信が暗号化されていたり不要な機能が止まっていれば、事故は防げます。'],
            ['category' => 'SYS', 'content' => 'リバースプロキシを介した構成は、本番サーバのIPアドレスやOS情報を外部から隠蔽し、直接攻撃を受けるリスクを下げます。また、SSL/TLS処理の集約やキャッシュ管理により、パフォーマンスとセキュリティの両立を助けます。'],
            ['category' => 'SYS', 'content' => 'TLS 1.3 は、脆弱な暗号スイートを廃止し、ハンドシェイクのステップを短縮した最新のプロトコルです。セキュリティ強度の向上だけでなく、通信開始までの待機時間（レイテンシ）も改善されるため、移行が強く推奨されています。'],
            ['category' => 'SYS', 'content' => 'コンテナイメージのセキュリティでは、不要なシェルや脆弱なパッケージを含まない「最小構成イメージ」を採用します。攻撃者がコンテナに侵入しても、その中で自由に動き回るためのツールを奪っておくことが、二次被害を防ぎます。'],
            ['category' => 'SYS', 'content' => 'IaC（Infrastructure as Code）のスキャンは、TerraformやCloudFormationの設定不備をデプロイ前に自動検知します。S3バケットの公開設定やFWのガバガバなルールといった「設定ミス」を防ぐ、クラウド時代の防衛術。'],
            ['category' => 'SYS', 'content' => '不適切なデータのデシリアライズは、受信したデータをオブジェクトに復元する際に悪意あるコードを実行させてしまう重大な脆弱性です。信頼できない相手からの受信データは、検証済みの安全な形式（JSON等）のみに限定して扱う。'],
            ['category' => 'SYS', 'content' => 'セキュアなエラーメッセージの設計では、エラー時に内部のスタックトレースやDBのカラム名を表示させてはいけません。攻撃者にシステムの詳細な構造を推測させるヒントを与えてしまい、より正確な攻撃への土台を作らせてしまいます。'],
            ['category' => 'SYS', 'content' => 'ソフトウェア構成分析 (SCA) は、使用しているOSSライブラリの脆弱性を自動でチェックする技術です。Log4jの深刻な脆弱性のようなケースを考慮し、自分たちのコードだけでなく、依存先の穴を常に管理し続けることが現代開発。'],
            ['category' => 'SYS', 'content' => '機密データのマスキングは、テスト環境や開発環境で本番データを使用する際に行います。メールアドレスや氏名の一部を伏せ字にすることで、開発担当者による意図しない漏えいリスクを下げつつ、実務に近いデータでの開発を可能にします。'],
            ['category' => 'SYS', 'content' => 'APIレートリミットは、短時間に大量のリクエストを送信してサーバを落とそうとするDoS攻撃や、ブルートフォース攻撃を制限します。IPアドレスごとの上限を設定することで、正当なユーザーの可用性を守りつつ、不審な挙動を抑止。'],
            ['category' => 'SYS', 'content' => 'ログの完全性は、事故発生後のフォレンジック調査において死活的に重要です。ログが攻撃者によって消されないよう、書き込み権限のみを持つログサーバへリアルタイム転送し、改ざん防止のハッシュ値を取得するなどの対策が推奨されます。'],
            ['category' => 'SYS', 'content' => 'コード署名は、ソフトウェアが配布元から改ざんされていないことを数学的に保証する技術です。OSやブラウザが署名を確認することで、マルウェアがインストーラーに仕込まれるのを防ぎ、ユーザーに安全なインストール環境を提供します。'],
            ['category' => 'SYS', 'content' => '安全なウェブサイトの作り方（IPA発行）は、日本の開発者がまず目を通すべきガイドラインです。主要な11種類の脆弱性について、具体的な被害例と根本的な解決策がまとめられており、RISS試験でもこの内容をベースに出題されます。'],
            ['category' => 'SYS', 'content' => '脆弱性情報のCVSS (Common Vulnerability Scoring System) は、深刻度を数値化して評価する世界標準の基準です。基本値・現状値・環境値の3要素で構成され、組織ごとの環境に応じたリスク判断の有力な物差しとして活用されます。'],
            ['category' => 'SYS', 'content' => 'SSRF (Server-Side Request Forgery) は、サーバを介して別の内部ネットワークなどにリクエストを送らせる攻撃です。クラウドプロバイダのメタデータ情報を奪われるリスクがあるため、内部ネットワークへのアクセス制限を厳格に設定。'],
            ['category' => 'SYS', 'content' => '入力値バリデーションは、拒否リスト形式ではなく「ホワイトリスト形式」で行います。許可された文字種、長さ、形式以外はすべて受け付けないという設計にすることで、未知の攻撃手法に対しても高い防御力を発揮することができます。'],
            ['category' => 'SYS', 'content' => 'セッションハイジャック対策では、クッキーに加えてIPアドレスやUser-Agentなどの変動しない情報をサーバー側で保持し、リクエストごとに検証を行います。これにより、単にクッキー情報が盗まれただけでは別端末からログインできません。'],
            ['category' => 'SYS', 'content' => 'TOTP (Time-based One-Time Password) は、時間と共に変化する使い捨てパスワードです。Google Authenticatorなどのアプリで生成され、たとえ一度だけ盗まれたとしても、数十秒後には無効になるため、高い安全性を誇る多要素認証です。'],
            ['category' => 'SYS', 'content' => 'デジタル署名は、「ハッシュ関数」と「公開鍵暗号」を組み合わせて実現されます。送信者が自身の秘密鍵でハッシュ値を暗号化し、受信者が送信者の公開鍵で復号することで、メッセージの「真正性」と「否認防止」を同時に確保します。'],
            ['category' => 'SYS', 'content' => 'ドメイン名ハイジャックは、ドメイン登録情報の管理不備を突いて、別のIPアドレスに向けさせる攻撃です。管理アカウントの多要素認証有効化や、レジストラ・ロック機能を活用し、サイト全体が乗っ取られる致命的な事態を防ぎます。'],
            ['category' => 'SYS', 'content' => 'ゾンビプロセスやメモリリークは、長期間の稼働によってサーバのリソースを枯渇させ、サービス停止を招くDoS状態を作り出します。セキュリティ対策だけでなく、丁寧なデバッグとメモリ管理は、システムの「可用性」を守るための必須要素です。'],
            ['category' => 'SYS', 'content' => 'Web Storage (LocalStorage/SessionStorage) はJavaScriptから簡単に読み書きできるため、機密情報（パスワードやトークン）の保存には適しません。XSSに対して極めて脆弱になるため、機密情報はHttpOnlyクッキーに保存する。'],
            ['category' => 'SYS', 'content' => 'XML外部実体参照 (XXE) 攻撃は、XMLファイルを解析する際に外部の不審なファイルを参照させてしまう攻撃です。対策として、XMLパーサの設定で「外部実体参照」を明示的に無効化し、意図しないファイル読み出しやDoSを防止します。'],
            ['category' => 'SYS', 'content' => 'ゼロトラストアーキテクチャでは、「一度認証されたらどこでも通信できる」というVPNモデルを廃止します。ネットワークの細分化（マイクロセグメンテーション）を行い、資産間の通信を常に監視・制御することで、攻撃の横展開を防ぎます。'],
        ];

        $ops = [
            ['category' => 'OPS', 'content' => 'SPF/DKIM/DMARCは、送信ドメイン認証技術の三本柱です。SPFは送信元IP、DKIMは電子署名で正当性を証明し、DMARCはこれらが失敗したメールを「隔離」するか「拒否」するかを受信側に指示する役割を担います。'],
            ['category' => 'OPS', 'content' => 'ゼロトラストモデルは、「信頼せず、常に確認する」ことを基本原則とします。ネットワークの内部と外部を区別せず、アクセスする全てのユーザー、デバイス、セッションごとに厳格な認証と認可を動的に行うことで、現代の脅威に対応します。'],
            ['category' => 'OPS', 'content' => 'ランサムウェア対策では、オフラインのバックアップが有効です。ネットワークから切り離された媒体や、一度書き込むと消去・変更ができない「Immutable（不変）ストレージ」に保管することで、バックアップ自体の破壊を防ぎます。'],
            ['category' => 'OPS', 'content' => '多要素認証 (MFA) は、「知識、所持、生体」の3要素のうち2つ以上を組み合わせます。パスワード（知識）が流出しても、物理トークン（所持）や指紋（生体）がなければログインできないため、不正アクセスを強力に抑止できます。'],
            ['category' => 'OPS', 'content' => 'SIEM (Security Information and Event Management) は、ネットワーク機器やサーバのログを集約し、相関分析を行います。「ログイン失敗の直後に重要ファイルへアクセス」といった、単体ログでは見えない攻撃の予兆をリアルタイムで検知します。'],
            ['category' => 'OPS', 'content' => 'Egressフィルタリング（出口対策）は、内部から外部への不審な通信を遮断します。マルウェアがC2サーバへ情報を送ったり、指令を受け取ったりする通信を止めることで、感染後の実害（データ流出等）を最小限に食い止めることができます。'],
            ['category' => 'OPS', 'content' => 'ソーシャルエンジニアリングは、人間の心理的な隙を突く攻撃手法です。管理者になりすました電話や緊急を装うメールなどが代表的。技術的な対策だけでなく、全従業員に対する継続的なセキュリティ教育こそが、唯一の対抗手段となります。'],
            ['category' => 'OPS', 'content' => '職務分掌 (Segregation of Duties) は、重要な処理を一人の権限で完結させない仕組みです。例えば、システム開発担当と本番反映承認者を分けることで、意図的な不正プログラムの混入や、不注意による事故を防ぐ体制を構築します。'],
            ['category' => 'OPS', 'content' => 'クリアデスク・クリアスクリーンは、机上に書類を残さず、離席時に画面をロックする運用です。不特定多数が出入りするオフィスでは、物理的な情報の盗み見や放置されたUSBメモリからの漏えいが多発するため、徹底した管理が必要です。'],
            ['category' => 'OPS', 'content' => 'パッチ管理 (Vulnerability Management) は、OSやアプリの脆弱性修正プログラムを迅速に適用するプロセスです。攻撃者はパッチ公開直後の「穴」を狙うため、緊急度に応じた適用ルールを定め、実施結果を追跡することが不可欠。'],
            ['category' => 'OPS', 'content' => '特権ID管理 (PAM) は、Administratorやrootといった強力な権限を持つアカウントの使用を制限・監視します。必要な時だけ一時的に権限を付与し、操作内容を全てログや動画で記録することで、内部不正や誤操作の抑止に繋がります。'],
            ['category' => 'OPS', 'content' => 'ハニーポットは、攻撃者をおびき寄せる「おとり」のシステムです。攻撃者の手口や目的を安全に観察できるだけでなく、ハニーポットへのアクセス自体が「侵入者がいる」という早期警戒アラートとしての役割も果たします。'],
            ['category' => 'OPS', 'content' => '踏み台攻撃は、セキュリティの甘い中継サーバを乗っ取り、そこから真の標的を攻撃する手法です。攻撃者は自身のIPを隠蔽するため、踏み台にされた組織は「加害者」として扱われるリスクがあるため、外部公開機器の管理は極めて重要です。'],
            ['category' => 'OPS', 'content' => 'DDoS攻撃のうち、ボリューム攻撃は大量の通信で回線をパンクさせます。一方、アプリケーション層攻撃はHTTPリクエスト等を大量に送り、サーバのCPUやメモリを枯渇させます。CDNによる分散処理やWAFでの挙動監視が有効な対策。'],
            ['category' => 'OPS', 'content' => 'DNSSECは、DNSの応答にデジタル署名を付与し、名前解決情報の改ざんを防ぎます。これにより、偽のIPアドレスへ誘導される「DNSキャッシュポイズニング」を阻止し、正当な通信先であることを保証するインフラ技術です。'],
            ['category' => 'OPS', 'content' => 'NTP増幅攻撃は、小さなリクエストに対して巨大な応答を返すNTPの仕様を悪用した反射攻撃です。送信元をターゲットのIPに偽装することで、大量のパケットを標的に送りつけます。不要なサービスの停止と監視が運用上の要です。'],
            ['category' => 'OPS', 'content' => 'ジャンプサーバ（踏み台サーバ）は、管理対象サーバへの唯一の入り口です。ここに多要素認証やログイン制限を集中させ、操作ログを厳重に取得することで、メンテナンス経路における特権アクセスの安全性を一元的に管理します。'],
            ['category' => 'OPS', 'content' => '3-2-1バックアップルールは、3つのコピー、2つの異なるメディア、1つの遠隔地保管を推奨します。これにより、単一の故障、メディアの劣化、そして地域災害に対しても、ビジネスの継続性を担保するデータの復元を可能にします。'],
            ['category' => 'OPS', 'content' => 'クラウドの責任共有モデルでは、インフラの保護はプロバイダが行いますが、OS・アプリ・データのセキュリティや設定は「利用者」の責任です。設定ミス一つでデータが全世界に公開されるリスクがあるため、設定の監査が不可欠。'],
            ['category' => 'OPS', 'content' => 'EDR (Endpoint Detection and Response) は、端末内の不審な挙動をリアルタイムで監視・記録します。通常のアンチウイルスをすり抜けた攻撃を検知し、即座にネットワーク遮断や感染経路の調査を可能にする現代の必須ツール。'],
            ['category' => 'OPS', 'content' => '物理的なデータ消去では、磁気消去や物理破壊、または複数回の上書きを行います。廃棄時には業者から「消去完了証明書」を受け取り、シリアル番号ベースで管理することで、物理的な情報漏えいルートを完全に断ち切ります。'],
            ['category' => 'OPS', 'content' => 'VPCフローログを活用すると、クラウド内のネットワークトラフィックを詳細に分析できます。許可されていない不審な通信の発見や、万が一の侵害時の被害範囲特定に役立ち、ネットワーク構成の妥当性を確認する材料ともなります。'],
            ['category' => 'OPS', 'content' => 'ネットワークセグメンテーションは、役割ごとにネットワークを分離する手法です。開発環境と本番環境、あるいは部署ごとに通信を制限することで、マルウェア感染時の「横移動（ラテラルムーブメント）」による被害拡大を抑止。'],
            ['category' => 'OPS', 'content' => 'サプライチェーンリスク管理では、委託先のセキュリティ水準を定期的に監査します。委託先踏み台攻撃が増えているため、契約による縛りだけでなく、実際の対策状況の報告や抜き打ち調査など、一貫したライフサイクル管理が求められます。'],
            ['category' => 'OPS', 'content' => 'BYOD（私物デバイスの業務利用）では、MDM（モバイルデバイス管理）による制御が欠かせません。紛失時のリモートワイプや、業務アプリデータの個人領域へのコピー禁止など、公私の分離と機密保護を技術的に担保します。'],
            ['category' => 'OPS', 'content' => 'シャドーIT（組織の許可なく使われるクラウド等）への対策は、単なる禁止では現場の反発を招きます。便利なツールの代替案を提示しつつ、CASBなどのツールで利用状況を可視化し、リスクベースで制御をかけるアプローチが現実的です。'],
            ['category' => 'OPS', 'content' => 'IDS（侵入検知）とIPS（侵入防止）の違いは、通信を遮断するかどうかです。IPSはシグネチャに基づき攻撃をリアルタイムに止めますが、過検知による正常通信の遮断リスクがあるため、適切なチューニングと監視がセットで必要です。'],
            ['category' => 'OPS', 'content' => 'USBメモリの利用禁止は、物理的な情報持ち出しとマルウェア感染の両方を防ぐ有効な手段です。やむを得ない場合は、暗号化機能付きの組織指定デバイスに限定し、読み書きの全履歴をログとして保存する運用を徹底しましょう。'],
            ['category' => 'OPS', 'content' => 'アクセスコントロールリスト (ACL) は、ルータやFWで特定のパケットの通過を許可・拒否するリストです。原則として「デフォル拒否」のポリシーを採用し、必要な最小限の通信だけを明示的に許可するのがセキュリティの鉄則。'],
            ['category' => 'OPS', 'content' => 'ダークウェブ監視サービスにより、漏えいした自組織の認証情報や、攻撃者の間でのターゲット情報を早期に察知できます。IDが売買されているのを早期発見し、強制パスワードリセット等の初動を打つことで侵入を未然に防ぎます。'],
            ['category' => 'OPS', 'content' => 'VPN装置の脆弱性は、攻撃者が社内に侵入するための最も一般的な窓口となっています。パッチ公開時は業務時間外であっても最優先で適用し、適用が完了するまでは監視のレベルを引き上げるなど、緊迫感のある運用。'],
            ['category' => 'OPS', 'content' => 'UPS（無停電電源装置）の保守では、定期的なセルフテストとバッテリー交換が必要です。停電時に正しく動作しなければ、システム障害やデータの破損を招くため、可用性を支える「最後の砦」として物理的な点検も欠かせません。'],
            ['category' => 'OPS', 'content' => 'シンクホール（Sinkhole）は、不正なドメインへの通信を解析用のサーバへリダイレクトする手法です。これにより、ボットに感染した社内端末を特定し、C2サーバとの通信を無効化することで、被害の拡大を効果的に食い止めます。'],
            ['category' => 'OPS', 'content' => 'ルートキット (Rootkit) は、OSの深部に潜み、自身のプロセスやファイルを隠蔽します。一度感染するとOS上の通常のツールでは検知が不可能になるため、OSを介さない外部からのスキャンや、振る舞い検知による発見が重要です。'],
            ['category' => 'OPS', 'content' => 'スレットハンティングは、IDS等のアラートを待つのではなく、能動的に侵入の形跡を探し出す活動です。正常時と異なる通信のゆらぎや、不自然な特権実行ログを分析し、潜伏している攻撃者を大きな実害が出る前にあぶり出します。'],
            ['category' => 'OPS', 'content' => 'ログローテーションの設定ミスでディスクがいっぱいになり、システムが停止する事案は後を絶ちません。可用性を守るため、ログの圧縮とパージルールを適切に設定し、重要なログは削除前に安全な外部サーバへ退避。'],
            ['category' => 'OPS', 'content' => '不変ログ（Immutable Log）は、書き込んだあとに消去や改ざんができない状態で保管されるログです。たとえ管理特権が奪われても、攻撃の証拠を消すことができないため、事故後の原因究明において強力な証拠能力を発揮。'],
            ['category' => 'OPS', 'content' => '脆弱性スキャナを定期的に活用し、資産台帳にない「野良サーバ」や、気づかないうちに有効化された不要サービスを発見します。技術的な不備を自動で洗い出し、修正の優先順位を付けることで、管理の死角をなくします。'],
            ['category' => 'OPS', 'content' => 'アンチパスバックは、入室の記録がない人の退室を禁じる（またはその逆）物理セキュリティ機能です。これにより、複数人が一人の認証で入る「共連れ」を制限し、エリア内に誰がいるかを正確に管理することが可能になります。'],
            ['category' => 'OPS', 'content' => 'フォールス・ポジティブ（誤検知）とフォールス・ネガティブ（見逃し）は、セキュリティ機器のトレードオフです。見逃しをゼロにしようと感度を上げすぎると、正常な業務まで止まってしまうため、運用を通じたチューニングが重要。'],
            ['category' => 'OPS', 'content' => 'セカンダリDNSの運用により、プライマリDNSがDDoS攻撃等でダウンしても、名前解決を継続できます。可用性の向上だけでなく、信頼できるセカンダリプロバイダを利用することで、インフラ全体のレジリエンスを高めることができます。'],
            ['category' => 'OPS', 'content' => '特権アクセスの二名立ち会い (Two-man rule) は、一人による不正を防ぐ人的セキュリティの極みです。特に影響の大きい作業（全データ消去等）において、互いに操作を監視することで、心理的な牽制とミス防止を同時に実現。'],
            ['category' => 'OPS', 'content' => '脅威インテリジェンスの活用により、世界中で現在流行している攻撃手法や接続元IPアドレスを自社の機器に自動反映できます。他社での被害事例を「教訓」として先回りして防衛することで、攻撃の成功率を劇的に下げます。'],
            ['category' => 'OPS', 'content' => 'シンクライアント環境やVDIの導入は、端末側にデータを残さないため、紛失や盗難による情報漏えいリスクを根本から取り除きます。テレワーク環境において、一元的な管理と安全性を両立させるための有力なインフラ構成。'],
            ['category' => 'OPS', 'content' => '物理的な鍵の管理において、マスターキーの貸出は必ず台帳に記録し、定期的な現物確認（棚卸し）を行います。紛失時は直ちに報告させ、必要に応じてシリンダーごと交換する判断を下すのが、物理セキュリティ担当者の重要な役割です。'],
            ['category' => 'OPS', 'content' => 'CASB (Cloud Access Security Broker) は、社員のクラウド利用を可視化・制御するソリューションです。データの持ち出し検知や、未承認SaaSの利用制限が可能で、境界が曖昧になった現代のクラウド活用を安全に支えます。'],
            ['category' => 'OPS', 'content' => 'ソーシャルメディア利用ガイドラインを策定し、従業員による不用意な発信（オフィスの写真、開発中の画面、不適切な発言等）を防ぎます。SNSは情報の拡散が速く、一人のミスが組織のブランド毀損や標的特定に直結。'],
            ['category' => 'OPS', 'content' => '定期的な「災害対策訓練」には、IT担当者だけでなく経営層も参加すべきです。システムが止まった際の代替手段や、外部への公表タイミングなど、技術だけでは解決できない高度な判断プロセスを平時から磨いておくことが不可欠です。'],
            ['category' => 'OPS', 'content' => 'L7 DDoS対策におけるキャプチャ（CAPTCHA）の導入は、ボットによる自動化された大量リクエストを遮断するのに有効です。正当なユーザーにはわずかな負担を強いますが、サーバのリソースを枯渇から守るための現実的な解決策となります。'],
            ['category' => 'OPS', 'content' => 'ディレクトリサービスの統合管理 (Active Directory等) により、一箇所の変更で全システムのアクセス権を即座に反映できます。退職者のアカウント削除漏れを防ぎ、適切な権限管理を効率的に行うための運用の要です。'],
        ];

        $inc = [
            ['category' => 'INC', 'content' => 'CSIRT (Computer Security Incident Response Team) は、事故発生時の司令塔です。技術的な調査のみならず、経営層への報告、法的対応、さらには再発防止策の策定まで、組織横断的な対応を主導する重要な役割を担います。'],
            ['category' => 'INC', 'content' => 'デジタルフォレンジックは、HDDやメモリから「証拠」を抽出し、何が起きたかを科學的に解明する技術です。法的証拠として認められるためには、データの完全性を担保するハッシュ値の記録など、厳格な証拠保全手順を遵守する必要があります。'],
            ['category' => 'INC', 'content' => 'インシデント対応の標準フローは「検知・分析」「初動対応」「封じ込め」「根絶」「復旧」「事後レビュー」です。各フェーズの実施内容を平時から定義しておくことで、有事のパニックを防ぎ、被害を最短・最小限に食い止めることができます。'],
            ['category' => 'INC', 'content' => 'SOC (Security Operations Center) は、24時間365日の監視を担当します。大量のアラートから「真の脅威」を抽出し、CSIRTへ繋ぐ「検知の要」です。SOC and CSIRT が密に連携することで、深夜や休日でも迅速な初動が可能です。'],
            ['category' => 'INC', 'content' => 'J-CRAT (サイバーレスキュー隊) は、標的型攻撃の被害を受けた組織を支援するためIPAに設置されたチームです。高度な攻撃に対し、現地での調査や解析、再発防止のアドバイスを無償で提供し、国全体の防衛力を支えています。'],
            ['category' => 'INC', 'content' => 'インシデントのトリアージは、複数の事故が重なった際に対応の優先順位を付けるプロセスです。ビジネスへの影響度、情報の機密性、被害の拡大速度を考慮し、限られたリソースをどこから投入すべきかを冷静に判断する経営判断そのもの。'],
            ['category' => 'INC', 'content' => '証拠保全の際は、対象機器の「オリジナル」には一切触れず、まずは「ストレージの複製（イメージ取得）」を作成します。解析作業はこの複製に対して行い、オリジナルを不変の状態で保管することで、調査の客観性と信頼性を維持します。'],
            ['category' => 'INC', 'content' => 'チェーン・オブ・カストディ（証拠保全の連鎖）は、証拠の発見から裁判所に提出するまでの「取り扱い履歴」を全て記録する仕組みです。誰が、いつ、どこで管理したかを明確に証明できない証拠は、法的な証拠価値を失う恐れがあるため、注意が必要です。'],
            ['category' => 'INC', 'content' => 'インシデント対応計画 (IRP) は、策定後の「訓練（演習）」が命です。机上での議論だけでなく、実際にPCを操作したり、外部機関への通報を行ったりする実地訓練を通じて、マニュアルの不備や担当者のスキル不足を洗い出します。'],
            ['category' => 'INC', 'content' => '封じ込め (Containment) は、被害の拡散を物理的・論理的に止めるフェーズです。感染したPCをLANから切り離す、悪用された管理パスワードを緊急変更するなどの初動を迅速に行うことで、感染の「横展開」を最小限の範囲に閉じ込めめます。'],
            ['category' => 'INC', 'content' => '根絶 (Eradication) は、攻撃の根本原因を取り除く作業です。マルウェアの駆除はもちろん、悪用された脆弱性へのパッチ適用や、攻撃者が密かに作成した「バックドアアカウント」の全削除など、再感染の種を完全に排除することが狙い。'],
            ['category' => 'INC', 'content' => '事後レビュー (Post-Mortem) は、対応完了後に「何が良く、何が悪かったか」を振り返り、教訓を次へ活かす活動です。犯人探しではなく、組織のプロセスや技術的な防御策の「盲点」を共有し、全体のレベルを底上げするための重要な活動です。'],
            ['category' => 'INC', 'content' => 'インシデント報告書には、事実関係を時系列（タイムライン）で整理し、特定された原因、実施した全措置、最終的な被害、および今後の再発防止策を網羅します。ステークホルダーへの透明性を確保し、失われた信頼を回復するための一歩となります。'],
            ['category' => 'INC', 'content' => 'JPCERT/CCは、日本国内のCSIRT活動を支援するコーディネーションセンターです。情報の集約や分析だけでなく、被害組織への助言や、新種のマルウェア情報の共有など、特定の企業枠を超えた官民連携のハブとして機能しています。'],
            ['category' => 'INC', 'content' => '揮発性データ（メモリの内容）は、電源を切ると消えてしまうため、調査の最優先順位となります。最近のウイルスはファイルとして残らない「ファイルレス形式」も多いため、RAMの内容を保全しないと、攻撃の足跡を一切追えないことになります。'],
            ['category' => 'INC', 'content' => 'IoC (Indicators of Compromise) は、侵害の痕跡を示す証拠（IP、ドメイン、ハッシュ値等）です。これらを業界内で共有し、自組織のログと照合することで、まだ気づいていない過去や現在の侵害を素早く、高い精度で検知。'],
            ['category' => 'INC', 'content' => 'TTPs (Tactics, Techniques, and Procedures) は、攻撃者の「戦略、技術、手順」を分析する概念です。個別のファイル名ではなく、「どのように権限を昇格させたか」といった攻撃パターンを理解することで、将来の類似攻撃を迎え撃つことが可能になります。'],
            ['category' => 'INC', 'content' => 'MITRE ATT&CKは、攻撃手法を体系化した世界標準のナレッジベースです。自社の監視ルールがどの攻撃フェーズをカバーできているかをマッピングし、守りの「穴」を客観的に可視化するための非常に強力なフレームワーク。'],
            ['category' => 'INC', 'content' => 'サイバーキルチェーンは、攻撃を「偵察、武器化、配送、発動、インストール、遠隔操作、目的実行」の7段階にモデル化します。このうち一箇所でも断ち切ることができれば攻撃は失敗に終わるため、多層防御の設計指針として活用されます。'],
            ['category' => 'INC', 'content' => 'プレイブックは、特定の攻撃シナリオ（例：不正送金の疑い）ごとに詳細な手順を記したマニュアルです。誰が対応しても一定のクオリティを保てるよう、判断基準、連絡先、操作手順がタスクリスト形式で体系化されています。'],
            ['category' => 'INC', 'content' => '机上演習 (Tabletop Exercise) は、仮想の事故シナリオに対し、関係者が集まって「各自の役割」や「判断プロセス」を議論する訓練です。安価かつ短時間で実施でき、組織内部の意思疎通のボトルネックや権限の不足を特定できます。'],
            ['category' => 'INC', 'content' => 'レッドチーム演習は、攻撃者の視点で「何でもあり」の擬似攻撃を行い、組織の対応能力をテストします。あらかじめ知らされていない不意打ちに対し、SOCや管理者が本当に正しく検知・初動。できるかを本番さながらの緊迫感で。'],
            ['category' => 'INC', 'content' => 'ブルーチームは、日々のログ監視、攻撃の検知、そして防御とインシデント対応を担当する防衛側の人員を指します。レッドチームに攻め込まれ、その手口を分析することを繰り返すことで、防衛の「筋肉」を鍛え上げていくのが目的です。'],
            ['category' => 'INC', 'content' => 'パープルチームは、攻撃側（レッド）と防衛側（ブルー）が敵対せず、密に知識を共有しながら防御力を高めるアプローチ。攻撃側が手口を教え、防衛側がその場で検知ルールを改善することで、最も効率的に学習できます。'],
            ['category' => 'INC', 'content' => 'スレットハンティングは、IDS等のアラートが出る前に、能動的に侵入の形跡を探す活動です。ログ分析や端末の不自然な挙動から「隠れた侵害」を見つけ出し、大きな実害（全データ流出等）が出る前の小さな火を消し止めます。'],
            ['category' => 'INC', 'content' => 'メモリフォレンジックでは、RAM上のプロセス、ネットワーク接続、読み込まれたDLL、さらには「削除済みのパスワード」までを抽出します。HDD上のファイルのみを見る調査では見落とされるような、実行中の悪質な活動をあぶり出すことができます。'],
            ['category' => 'INC', 'content' => 'ライトブロッカー（書き込み防止装置）は、HDDのデータを吸取する際に、OS側からの書き込みを物理的に遮断します。これにより、証拠保全作業中に「データを汚染していない」ことを証明でき、裁判等での証拠能力を確実なものにします。'],
            ['category' => 'INC', 'content' => 'タイムライン分析は、各機器のログやファイルスタンプを一列に並べ、犯行の全体像を把握する手法です。「どの端末が最初に侵入され、いつ lateral movement が起きたか」を一目で可視化し、原因調査の精度を劇的に向上させます。'],
            ['category' => 'INC', 'content' => 'プレフェッチ (Prefetch) ファイルの解析により、Windows上で過去に「どのプログラムが、いつ、何回実行されたか」がわかります。マルウェア本体を消去されても、その実行履歴を掴むことで、攻撃の足跡を科学的に証明できます。'],
            ['category' => 'INC', 'content' => 'Windowsレジストリには、OS設定や外部デバイス（USB等）の接続履歴、自動起動設定などが記録されています。これを丁寧に読み解くことで、組織のルールに違反した不正行為や、高度な隠蔽工作の形跡を特定することが可能になります。'],
            ['category' => 'INC', 'content' => 'イベントログのID 4624 (ログオン成功) は調査の基礎。その中の「ログオンタイプ」を見れば、物理アクセスの「タイプ2」か、ネットワーク経由の「タイプ3」か、リモートデスクトップの「タイプ10」かが分かり、侵入経路が鮮明に。'],
            ['category' => 'INC', 'content' => 'PowerShellの「スクリプトブロックロギング」を有効にすると、難読化されたスクリプトが「実行直前のプレーンな中身」の状態でログに残ります。攻撃者が多用する高度なコマンドライン攻撃の実態を捉える唯一の手段となります。'],
            ['category' => 'INC', 'content' => 'Mimikatzは、メモリから認証情報（ハッシュや平文パスワード）をダンプする有名な攻撃用ツールです。このツールの不審な挙動を検知することは、組織内での「横方向への感染拡大」を早期に発見・阻止するために極めて有効です。'],
            ['category' => 'INC', 'content' => 'ゴールデンチケット攻撃は、ADの権限管理を司る「KRBTGT」のハッシュを盗み、無制限の権限を得る手法。ひとたびこれが許されると、全パスワードを変えても侵入を防げない壊滅的な状況を招くため、ADサーバの防御は最優先。'],
            ['category' => 'INC', 'content' => 'ネットワークパケット解析 (pcap調査) では、マルウェアがC2サーバと定期的に通信する「ビーコン」の特定が行えます。通信間隔の周期性を分析することで、IDSでは見逃されるような低頻度の不審なアウトバウンド通信も検知できます。'],
            ['category' => 'INC', 'content' => 'マルウェアサンドボックスは、不審なファイルを隔離環境で実行させ、その振る舞い（ファイル作成、通信、レジストリ変更等）を自動で動的解析します。安全な環境で敵の正体を知ることで、迅速な封じ込め戦略の立案を可能にします。'],
            ['category' => 'INC', 'content' => 'インパクトアセスメント（影響調査）では、漏えいしたデータの機密区分と法的・社会的リスクを評価。被害人数の精査と並行し、個人情報保護委員会への報告要否や公表のタイミングについて、法務と連携して迅速に行います。'],
            ['category' => 'INC', 'content' => 'インシデント対応の費用対効果分析では、調査費、復旧費、機会損失、そしてブランド毀損額を数値化。これを経営層に提示することで、将来のセキュリティ投資への理解を得るための強力なエビデンスとして役立てることができます。'],
            ['category' => 'INC', 'content' => 'OSINT (Open Source Intelligence) により、SNSやダークウェブ上の掲示板を監視。自組織のドメインに紐づくID販売や、攻撃グループによる新たな犯行予告、脆弱性の悪用コードの流通を先回りして察知します。'],
            ['category' => 'INC', 'content' => 'アノマリー検知は、統計的に「普段と違う動き」を見つけます。「深夜に海外へ数GBの送信（データ持ち出し）」など、シグネチャベースでは防げない未知の攻撃や内部不正を浮かび上がらせるため、最新のSOC運用に取り入れられています。'],
            ['category' => 'INC', 'content' => 'シンクホール（Sinkhole）運用では、感染端末の正確な「特定」と「隔離」を目的とします。C2ドメインのリクエストを自分で受けることで、どの端末がゾンビ化しているかを一目で把握し、迅速なトリアージと初動対応に繋げます。'],
            ['category' => 'INC', 'content' => 'フォレンジック時の「タイム・ストンプ（日時改ざん）」への対策。高度なハッカーはログのタイムスタンプを書き換えて解析を攪乱しますが、MFTの隠し領域などの複数のタイムスタンプを比較検証することで、矛盾を突き止めることができます。'],
            ['category' => 'INC', 'content' => 'SIEMの相関分析により、「何度もログインに失敗したあとに成功、直後にPowerShellで外部通信」といった、複数の無関係に見える独立したイベントを一つの「ストーリー」として検知。攻撃者の足跡を点から線へ繋ぎます。'],
            ['category' => 'INC', 'content' => '個人情報保護法改正により、漏えい等が発生し「個人の権利利益を害するおそれがある場合」などは、委員会への報告と本人への通知が法定義務となりました。初動の成否は法令遵守の観点からも極めて重要な意味を持ちます。'],
            ['category' => 'INC', 'content' => 'ペネトレーションテストの「出口対策検証」では、侵入を前提として、「重要データを外部に持ち出せるか」を実地でテストします。WAFなどの入口の壁だけでなく、社内から外への通信を止めるルールの実効性を評価します。'],
            ['category' => 'INC', 'content' => '脆弱性情報 (JVN/VRS等) を受け取った際は、「CVSSの基本値」だけで判断せず、自社での「露出度」や「想定被害額」を加味した優先度付けを。パッチ適用を一律にするのではなく、リスクベースでリソースを投入しましょう。'],
            ['category' => 'INC', 'content' => 'BCP（事業継続計画）とインシデント対応は表裏一体。サイバー攻撃による長期システムダウンは巨大な地震と同様の「経営危機」であり、どの業務から優先復旧させるかを全全社レベルで合意しておくことが、レジリエンス（回復力）を高める鍵となります。'],
            ['category' => 'INC', 'content' => '「失敗を責めない」文化こそが、迅速なインシデント報告の秘訣です。情報を隠蔽せず即座に共有される環境を整えることが、被害を最小限に食い止め、組織としての自浄能力と防衛力を高めます。'],
            ['category' => 'INC', 'content' => 'デジタルフォレンジックにおいて、ビット単位でのイメージ取得は基本です。単なるファイルコピーでは「削除されたファイルの痕跡」が失われるため、ビットコピーを行うことで隠された攻撃の証拠を探し出します。'],
            ['category' => 'INC', 'content' => 'インシデント対応チーム (CSIRT) は、平時から社外の外部CSIRTや警察との連携パイプを築いておくべきです。いざという時に「誰を頼ればよいか」が明確になっていることが、復旧の速度を左右します。'],
        ];

        $allData = array_merge($mgt, $sys, $ops, $inc);

        foreach ($allData as $item) {
            SecurityTrivia::create($item);
        }
    }
}
